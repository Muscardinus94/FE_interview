# Web - 브라우저 작동원리

## 설명
기본적으로 브라우저는 사용자가 참조하고자 하는 웹페이지를 서버에 요청(Request)하고 서버의 응답(Response)을 받아 브라우저에 표시하는 것입니다.

## 브라우저 기본 구조
사용자 인터페이스 -> 브라우저 엔진 -> 렌더링 엔진 -> 통신, 자바스크립트 해석기, UI 백엔드
사용자 인터페이스와 렌더링 엔진 사이의 동작을 브라우저 엔진이 제어하게됩니다. 그리고 렌더링 엔진에서 요청한 콘텐츠를 화면에 표시하게됩니다.

## 브라우저 렌더링 과정
1. 서버에서 HTML,CSS등 웹 사이트에 필요한 리소스를 다운받습니다.   
2. HTML을 파싱하여 DOM Tree를 생성합니다. 마찬가지로 CSS를 파싱하여 CSSOM Tree를 생성합니다.
3. DOM Tree와 CSSOM Tree를 합친 Render Tree를 생성합니다. 렌더트리는 실제 화면에 표현되는 노드들로만 구성됩니다.   
   참고로 display:none 속성같은 경우는 화면에 어떠한 공간도 차지하지 않기 때문에 렌더트리에서 제외됩니다.
4. Layout에서는 뷰포트 내에서 각 노드들의 위치와 크기를 계산합니다. 이때 퍼센트,vh,vw와 같은 상대적인 측정값은 화면에서 절대적인 픽셀단위로 변환됩니다.
5. 마지막으로 요소들을 실제 화면에 그리게 됩니다.이 단계를 페인팅 단계라고 합니다.

위 과정이 다 끝난 뒤 이벤트에따라 새로운 HTML 요소가 추가되거나, 기존 태그들의 스타일이 변경되면 렌더트리와 각 요소들의 크기와 위치를 다시 계산하게됩니다.   
이러한 과정을 Reflow라고 합니다.
리플로우단계는 변경사항을 반영하기위해 렌더트리를 다시 생성하고 Layout과정을 다시 수행하는 것이고 실제 화면에 그리기위해서는 다시 페인팅 단계를 수행해야됩니다.   
이러한 과정을 RePaint라고 합니다.
항상 리플로우 -> 리페인트 단계를 거치는게 아니고 레이아웃에 영향을 미치지않는 background-color 변경 같은 경우는 바로 리페인트만 수행하게 됩니다.

## 요약
- 사용자 인터페이스와 렌더링 엔진 사이의 동작을 브라우저 엔진이 제어하게되며 렌더링 엔진에서 요청한 콘텐츠를 화면에 표시하게됩니다.
- 브라우저 렌더링 과정은 서버에서 받은 HTML,CSS 파싱 -> DOM,CSSOM Tree생성 -> Render Tree생성 -> Layout -> Paint 순서로 진행됩니다.

## 참고
https://poiemaweb.com/js-browser
https://d2.naver.com/helloworld/59361